<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.66">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/studyLib/assets/icon.jpeg"><title>手写简单的webpack | 学习资源库</title><meta name="description" content="一个用于学习的 VuePress 站点">
    <link rel="preload" href="/studyLib/assets/style-97653313.css" as="style"><link rel="stylesheet" href="/studyLib/assets/style-97653313.css">
    <link rel="modulepreload" href="/studyLib/assets/app-72993491.js"><link rel="modulepreload" href="/studyLib/assets/005手写简单webpack.html-2bf49e9b.js"><link rel="modulepreload" href="/studyLib/assets/005手写简单webpack.html-b669b110.js"><link rel="prefetch" href="/studyLib/assets/index.html-2efa10d1.js" as="script"><link rel="prefetch" href="/studyLib/assets/001offer.html-bac406b1.js" as="script"><link rel="prefetch" href="/studyLib/assets/001Sort.html-befbd5f8.js" as="script"><link rel="prefetch" href="/studyLib/assets/002LinkList.html-d9751673.js" as="script"><link rel="prefetch" href="/studyLib/assets/003BinaryTree.html-7e39dc29.js" as="script"><link rel="prefetch" href="/studyLib/assets/004Graph.html-73dd72b0.js" as="script"><link rel="prefetch" href="/studyLib/assets/005TrieTree.html-fb5bbdee.js" as="script"><link rel="prefetch" href="/studyLib/assets/006Greedy.html-463b0c00.js" as="script"><link rel="prefetch" href="/studyLib/assets/007BruteForceRecursion.html-c32612ce.js" as="script"><link rel="prefetch" href="/studyLib/assets/008Hash.html-dfd72b4a.js" as="script"><link rel="prefetch" href="/studyLib/assets/009DisjointSet.html-c1da4bda.js" as="script"><link rel="prefetch" href="/studyLib/assets/010KMP.html-08dc4939.js" as="script"><link rel="prefetch" href="/studyLib/assets/011Manacher.html-851a418a.js" as="script"><link rel="prefetch" href="/studyLib/assets/012Window.html-35ce89c5.js" as="script"><link rel="prefetch" href="/studyLib/assets/013大数据.html-08dc39af.js" as="script"><link rel="prefetch" href="/studyLib/assets/014位运算.html-7156ded7.js" as="script"><link rel="prefetch" href="/studyLib/assets/015动态规划.html-19b0a341.js" as="script"><link rel="prefetch" href="/studyLib/assets/016有序表.html-bd8c7167.js" as="script"><link rel="prefetch" href="/studyLib/assets/001es.html-61c7fbb3.js" as="script"><link rel="prefetch" href="/studyLib/assets/002lodash.html-2bcf0815.js" as="script"><link rel="prefetch" href="/studyLib/assets/003coding.html-f5926cd9.js" as="script"><link rel="prefetch" href="/studyLib/assets/001打包资源处理.html-24cdc3ab.js" as="script"><link rel="prefetch" href="/studyLib/assets/002webpack配置.html-220baa49.js" as="script"><link rel="prefetch" href="/studyLib/assets/003包管理工具.html-159b64a3.js" as="script"><link rel="prefetch" href="/studyLib/assets/004Bundless.html-ae5a7555.js" as="script"><link rel="prefetch" href="/studyLib/assets/006模块化方案.html-9a5a76f5.js" as="script"><link rel="prefetch" href="/studyLib/assets/007package和npm.html-8a15325e.js" as="script"><link rel="prefetch" href="/studyLib/assets/008前端质量保障.html-dfab7e01.js" as="script"><link rel="prefetch" href="/studyLib/assets/010rspack.html-19004f0d.js" as="script"><link rel="prefetch" href="/studyLib/assets/001CSS.html-77bdfb21.js" as="script"><link rel="prefetch" href="/studyLib/assets/002Browser.html-fb8c4e1d.js" as="script"><link rel="prefetch" href="/studyLib/assets/003JS.html-6511db18.js" as="script"><link rel="prefetch" href="/studyLib/assets/004Vue.html-60dc2bc0.js" as="script"><link rel="prefetch" href="/studyLib/assets/005React.html-9ec40e07.js" as="script"><link rel="prefetch" href="/studyLib/assets/006工程化.html-4474284b.js" as="script"><link rel="prefetch" href="/studyLib/assets/007Http.html-024ba735.js" as="script"><link rel="prefetch" href="/studyLib/assets/008算法.html-a7f80b9d.js" as="script"><link rel="prefetch" href="/studyLib/assets/011前端调试.html-2653b38b.js" as="script"><link rel="prefetch" href="/studyLib/assets/012装饰器.html-1143f938.js" as="script"><link rel="prefetch" href="/studyLib/assets/997面试题整理.html-30dd7c1f.js" as="script"><link rel="prefetch" href="/studyLib/assets/998HR面.html-4fe89dde.js" as="script"><link rel="prefetch" href="/studyLib/assets/999Other.html-2bafb8e9.js" as="script"><link rel="prefetch" href="/studyLib/assets/001nestjs.html-323234b5.js" as="script"><link rel="prefetch" href="/studyLib/assets/002nestjs装饰器.html-0fb187a0.js" as="script"><link rel="prefetch" href="/studyLib/assets/003nestjs切换上下文.html-97aab697.js" as="script"><link rel="prefetch" href="/studyLib/assets/001React.html-cf1dd876.js" as="script"><link rel="prefetch" href="/studyLib/assets/001Vue.html-fce47e30.js" as="script"><link rel="prefetch" href="/studyLib/assets/404.html-f9875e7b.js" as="script"><link rel="prefetch" href="/studyLib/assets/index.html-0c7c69f6.js" as="script"><link rel="prefetch" href="/studyLib/assets/001offer.html-191fdbe5.js" as="script"><link rel="prefetch" href="/studyLib/assets/001Sort.html-280b53df.js" as="script"><link rel="prefetch" href="/studyLib/assets/002LinkList.html-fb9c1719.js" as="script"><link rel="prefetch" href="/studyLib/assets/003BinaryTree.html-9a24013b.js" as="script"><link rel="prefetch" href="/studyLib/assets/004Graph.html-0dad7abb.js" as="script"><link rel="prefetch" href="/studyLib/assets/005TrieTree.html-34ca2d6a.js" as="script"><link rel="prefetch" href="/studyLib/assets/006Greedy.html-78f96504.js" as="script"><link rel="prefetch" href="/studyLib/assets/007BruteForceRecursion.html-b2eb33b2.js" as="script"><link rel="prefetch" href="/studyLib/assets/008Hash.html-244a9c67.js" as="script"><link rel="prefetch" href="/studyLib/assets/009DisjointSet.html-cfc4bfc7.js" as="script"><link rel="prefetch" href="/studyLib/assets/010KMP.html-2398b546.js" as="script"><link rel="prefetch" href="/studyLib/assets/011Manacher.html-4b7ab50b.js" as="script"><link rel="prefetch" href="/studyLib/assets/012Window.html-42f82a81.js" as="script"><link rel="prefetch" href="/studyLib/assets/013大数据.html-0dcbf045.js" as="script"><link rel="prefetch" href="/studyLib/assets/014位运算.html-aa0f7ce8.js" as="script"><link rel="prefetch" href="/studyLib/assets/015动态规划.html-83a6ee15.js" as="script"><link rel="prefetch" href="/studyLib/assets/016有序表.html-7be4c959.js" as="script"><link rel="prefetch" href="/studyLib/assets/001es.html-18faa3ab.js" as="script"><link rel="prefetch" href="/studyLib/assets/002lodash.html-27e15aa1.js" as="script"><link rel="prefetch" href="/studyLib/assets/003coding.html-472500dc.js" as="script"><link rel="prefetch" href="/studyLib/assets/001打包资源处理.html-079090a7.js" as="script"><link rel="prefetch" href="/studyLib/assets/002webpack配置.html-1c5b4b6b.js" as="script"><link rel="prefetch" href="/studyLib/assets/003包管理工具.html-aea79c2b.js" as="script"><link rel="prefetch" href="/studyLib/assets/004Bundless.html-ee1d00f3.js" as="script"><link rel="prefetch" href="/studyLib/assets/006模块化方案.html-1cb5a0fc.js" as="script"><link rel="prefetch" href="/studyLib/assets/007package和npm.html-f059a92c.js" as="script"><link rel="prefetch" href="/studyLib/assets/008前端质量保障.html-a2f1ba4f.js" as="script"><link rel="prefetch" href="/studyLib/assets/010rspack.html-bb5ff69e.js" as="script"><link rel="prefetch" href="/studyLib/assets/001CSS.html-d1d3362c.js" as="script"><link rel="prefetch" href="/studyLib/assets/002Browser.html-aaf69bf6.js" as="script"><link rel="prefetch" href="/studyLib/assets/003JS.html-deb0bda6.js" as="script"><link rel="prefetch" href="/studyLib/assets/004Vue.html-e1a4995f.js" as="script"><link rel="prefetch" href="/studyLib/assets/005React.html-b6a0b20d.js" as="script"><link rel="prefetch" href="/studyLib/assets/006工程化.html-b5a145c3.js" as="script"><link rel="prefetch" href="/studyLib/assets/007Http.html-b5f4113b.js" as="script"><link rel="prefetch" href="/studyLib/assets/008算法.html-08a07cf3.js" as="script"><link rel="prefetch" href="/studyLib/assets/011前端调试.html-4aa4bd45.js" as="script"><link rel="prefetch" href="/studyLib/assets/012装饰器.html-b7656a34.js" as="script"><link rel="prefetch" href="/studyLib/assets/997面试题整理.html-fc44ed4d.js" as="script"><link rel="prefetch" href="/studyLib/assets/998HR面.html-d0fbcf2a.js" as="script"><link rel="prefetch" href="/studyLib/assets/999Other.html-82442ece.js" as="script"><link rel="prefetch" href="/studyLib/assets/001nestjs.html-88dfddd2.js" as="script"><link rel="prefetch" href="/studyLib/assets/002nestjs装饰器.html-c78d21e8.js" as="script"><link rel="prefetch" href="/studyLib/assets/003nestjs切换上下文.html-e7c74e97.js" as="script"><link rel="prefetch" href="/studyLib/assets/001React.html-63986f09.js" as="script"><link rel="prefetch" href="/studyLib/assets/001Vue.html-4cac51c8.js" as="script"><link rel="prefetch" href="/studyLib/assets/404.html-11fb8e97.js" as="script"><link rel="prefetch" href="/studyLib/assets/mermaid.core-d22b6d45.js" as="script"><link rel="prefetch" href="/studyLib/assets/markdown.esm-abe06b83.js" as="script"><link rel="prefetch" href="/studyLib/assets/reveal.esm-ec5549c1.js" as="script"><link rel="prefetch" href="/studyLib/assets/VuePlayground-eb9a6c49.js" as="script"><link rel="prefetch" href="/studyLib/assets/giscus-765fdce2.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="切换侧边栏" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/studyLib/" class=""><!----><span class="site-name">学习资源库</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/studyLib/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/studyLib/algorithm/001Sort.md" class="" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/studyLib/LeetCode/001offer.md" class="" aria-label="LeetCode"><!--[--><!--]--> LeetCode <!--[--><!--]--></a></div><div class="navbar-item"><a href="/studyLib/engineering/001打包资源处理.md" class="" aria-label="工程化"><!--[--><!--]--> 工程化 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="框架"><span class="title">框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="框架"><span class="title">框架</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/studyLib/framework/vue/001Vue.md" class="" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/studyLib/framework/react/001React.md" class="" aria-label="React"><!--[--><!--]--> React <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/studyLib/framework/nestjs/001nestjs.md" class="" aria-label="NestJS"><!--[--><!--]--> NestJS <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="面试"><span class="title">面试</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="面试"><span class="title">面试</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/studyLib/questions/001CSS.md" class="" aria-label="问题"><!--[--><!--]--> 问题 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/studyLib/coding/001es.md" class="" aria-label="代码"><!--[--><!--]--> 代码 <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/studyLib/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/studyLib/algorithm/001Sort.md" class="" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/studyLib/LeetCode/001offer.md" class="" aria-label="LeetCode"><!--[--><!--]--> LeetCode <!--[--><!--]--></a></div><div class="navbar-item"><a href="/studyLib/engineering/001打包资源处理.md" class="" aria-label="工程化"><!--[--><!--]--> 工程化 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="框架"><span class="title">框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="框架"><span class="title">框架</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/studyLib/framework/vue/001Vue.md" class="" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/studyLib/framework/react/001React.md" class="" aria-label="React"><!--[--><!--]--> React <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/studyLib/framework/nestjs/001nestjs.md" class="" aria-label="NestJS"><!--[--><!--]--> NestJS <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="面试"><span class="title">面试</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="面试"><span class="title">面试</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/studyLib/questions/001CSS.md" class="" aria-label="问题"><!--[--><!--]--> 问题 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/studyLib/coding/001es.md" class="" aria-label="代码"><!--[--><!--]--> 代码 <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/studyLib/engineering/001%E6%89%93%E5%8C%85%E8%B5%84%E6%BA%90%E5%A4%84%E7%90%86.html" class="sidebar-item sidebar-heading" aria-label="打包资源处理"><!--[--><!--]--> 打包资源处理 <!--[--><!--]--></a><!----></li><li><a href="/studyLib/engineering/002webpack%E9%85%8D%E7%BD%AE.html" class="sidebar-item sidebar-heading" aria-label="webpack配置"><!--[--><!--]--> webpack配置 <!--[--><!--]--></a><!----></li><li><a href="/studyLib/engineering/003%E5%8C%85%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7.html" class="sidebar-item sidebar-heading" aria-label="包管理工具"><!--[--><!--]--> 包管理工具 <!--[--><!--]--></a><!----></li><li><a href="/studyLib/engineering/004Bundless.html" class="sidebar-item sidebar-heading" aria-label="Bundless"><!--[--><!--]--> Bundless <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/engineering/005%E6%89%8B%E5%86%99%E7%AE%80%E5%8D%95webpack.html" class="router-link-active router-link-exact-active router-link-active sidebar-item sidebar-heading active" aria-label="手写简单的webpack"><!--[--><!--]--> 手写简单的webpack <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/studyLib/engineering/005%E6%89%8B%E5%86%99%E7%AE%80%E5%8D%95webpack.html#仓库地址" class="router-link-active router-link-exact-active sidebar-item" aria-label="仓库地址"><!--[--><!--]--> 仓库地址 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/engineering/005%E6%89%8B%E5%86%99%E7%AE%80%E5%8D%95webpack.html#代码" class="router-link-active router-link-exact-active sidebar-item" aria-label="代码"><!--[--><!--]--> 代码 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/studyLib/engineering/006%E6%A8%A1%E5%9D%97%E5%8C%96%E6%96%B9%E6%A1%88.html" class="sidebar-item sidebar-heading" aria-label="模块化方案"><!--[--><!--]--> 模块化方案 <!--[--><!--]--></a><!----></li><li><a href="/studyLib/engineering/007package%E5%92%8Cnpm.html" class="sidebar-item sidebar-heading" aria-label="关于package和npm"><!--[--><!--]--> 关于package和npm <!--[--><!--]--></a><!----></li><li><a href="/studyLib/engineering/008%E5%89%8D%E7%AB%AF%E8%B4%A8%E9%87%8F%E4%BF%9D%E9%9A%9C.html" class="sidebar-item sidebar-heading" aria-label="前端质量保障"><!--[--><!--]--> 前端质量保障 <!--[--><!--]--></a><!----></li><li><a href="/studyLib/engineering/010rspack.html" class="sidebar-item sidebar-heading" aria-label="Rspack初体验 2023/8/21"><!--[--><!--]--> Rspack初体验 2023/8/21 <!--[--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="手写简单的webpack" tabindex="-1"><a class="header-anchor" href="#手写简单的webpack" aria-hidden="true">#</a> 手写简单的webpack</h1><h2 id="仓库地址" tabindex="-1"><a class="header-anchor" href="#仓库地址" aria-hidden="true">#</a> 仓库地址</h2><p><a href="https://github.com/lxy951101/mini-webpack/tree/main" target="_blank" rel="noopener noreferrer">mini-webpack<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a></p><h2 id="代码" tabindex="-1"><a class="header-anchor" href="#代码" aria-hidden="true">#</a> 代码</h2><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> readFileSync<span class="token punctuation">,</span> writeFileSync<span class="token punctuation">,</span> mkdirSync<span class="token punctuation">,</span> existsSync <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;fs&#39;</span>
<span class="token keyword">import</span> parser <span class="token keyword">from</span> <span class="token string">&#39;@babel/parser&#39;</span>
<span class="token keyword">import</span> traverse <span class="token keyword">from</span> <span class="token string">&#39;@babel/traverse&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> fileURLToPath <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;url&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> dirname<span class="token punctuation">,</span> join<span class="token punctuation">,</span> resolve <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;path&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;ejs&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> transformFromAst <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;babel-core&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> SyncHook <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;tapable&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> jsonLoader <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./jsonLoader.js&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> MyPlugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./MyPlugin.js&#39;</span>

<span class="token keyword">const</span> __filename <span class="token operator">=</span> <span class="token function">fileURLToPath</span><span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
<span class="token keyword">const</span> __dirname <span class="token operator">=</span> <span class="token function">dirname</span><span class="token punctuation">(</span>__filename<span class="token punctuation">)</span>



<span class="token keyword">let</span> chunkId <span class="token operator">=</span> <span class="token number">1</span>

<span class="token keyword">function</span> <span class="token function">createAssets</span><span class="token punctuation">(</span><span class="token parameter">path<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 入口文件</span>
    <span class="token keyword">let</span> source <span class="token operator">=</span> <span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">encoding</span><span class="token operator">:</span> <span class="token string">&#39;utf-8&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// loader</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> rules <span class="token punctuation">}</span> <span class="token operator">=</span> options

    <span class="token keyword">const</span> loaderContext <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">deps</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token function">addDeps</span><span class="token punctuation">(</span><span class="token parameter">loader</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>deps<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>loader<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    rules<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> test<span class="token punctuation">,</span> use <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>test<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>use<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                use <span class="token operator">=</span> <span class="token punctuation">[</span>use<span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
            source <span class="token operator">=</span> use<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">source<span class="token punctuation">,</span> loader</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">loader</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>loaderContext<span class="token punctuation">)</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">,</span> source<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// ast解析</span>
    <span class="token keyword">const</span> ast <span class="token operator">=</span> parser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span> <span class="token punctuation">{</span> 
        <span class="token literal-property property">sourceType</span><span class="token operator">:</span> <span class="token string">&#39;module&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// 收集依赖</span>
    <span class="token keyword">const</span> deps <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    traverse<span class="token punctuation">.</span><span class="token function">default</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token function">ImportDeclaration</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> node <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            deps<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>source<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">const</span> <span class="token punctuation">{</span> code <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">transformFromAst</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">presets</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;env&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">filePath</span><span class="token operator">:</span> path<span class="token punctuation">,</span>
        source<span class="token punctuation">,</span>
        <span class="token literal-property property">code</span><span class="token operator">:</span> code<span class="token punctuation">,</span>
        deps<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 构建图</span>
<span class="token keyword">function</span> <span class="token function">createGraph</span><span class="token punctuation">(</span><span class="token parameter">path<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> mainDir <span class="token operator">=</span> <span class="token function">dirname</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
    <span class="token keyword">const</span> mainAsset <span class="token operator">=</span> <span class="token function">createAssets</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
    <span class="token keyword">const</span> queue <span class="token operator">=</span> <span class="token punctuation">[</span>mainAsset<span class="token punctuation">]</span>
    

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> asset <span class="token keyword">of</span> queue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> mapping <span class="token operator">=</span> asset<span class="token punctuation">.</span>mapping <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        asset<span class="token punctuation">.</span>deps<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">relativePath</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> childPath <span class="token operator">=</span> <span class="token function">resolve</span><span class="token punctuation">(</span>mainDir<span class="token punctuation">,</span> relativePath<span class="token punctuation">)</span>
            <span class="token keyword">const</span> childAsset <span class="token operator">=</span> <span class="token function">createAssets</span><span class="token punctuation">(</span>childPath<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
            mapping<span class="token punctuation">[</span>relativePath<span class="token punctuation">]</span> <span class="token operator">=</span> chunkId<span class="token operator">++</span>
            queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>childAsset<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> queue
<span class="token punctuation">}</span>

<span class="token comment">// 构建</span>
<span class="token keyword">function</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> newOptions <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>
        input<span class="token punctuation">,</span>
        output<span class="token punctuation">,</span>
        rules<span class="token punctuation">,</span>
        plugins<span class="token punctuation">,</span>
    <span class="token punctuation">}</span> <span class="token operator">=</span> newOptions
    <span class="token keyword">const</span> hooks <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">emit</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">SyncHook</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;context&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> compiler <span class="token operator">=</span> <span class="token punctuation">{</span>
        hooks
    <span class="token punctuation">}</span>

    plugins<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">plugin</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">plugin</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>compiler<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> template <span class="token operator">=</span> <span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#39;template.ejs&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">encoding</span><span class="token operator">:</span> <span class="token string">&#39;utf-8&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> entry <span class="token operator">=</span> <span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> input<span class="token punctuation">)</span>
    <span class="token keyword">const</span> graph <span class="token operator">=</span> <span class="token function">createGraph</span><span class="token punctuation">(</span>entry<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> graph<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">asset<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">chunkId</span><span class="token operator">:</span> asset<span class="token punctuation">.</span>filePath<span class="token punctuation">,</span>
            <span class="token literal-property property">code</span><span class="token operator">:</span> asset<span class="token punctuation">.</span>code<span class="token punctuation">,</span>
            <span class="token literal-property property">mapping</span><span class="token operator">:</span> asset<span class="token punctuation">.</span>mapping<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">let</span> code <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> <span class="token punctuation">{</span>data<span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token function">changeCode</span><span class="token punctuation">(</span><span class="token parameter">newCode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            code <span class="token operator">=</span> newCode
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> code<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    hooks<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>

    <span class="token function">ensureDir</span><span class="token punctuation">(</span><span class="token function">dirname</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token function">writeFileSync</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> code<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">ensureDir</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> dirPath <span class="token operator">=</span> <span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> path<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">existsSync</span><span class="token punctuation">(</span>dirPath<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> dirPath<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">mkdirSync</span><span class="token punctuation">(</span>dirPath<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">input</span><span class="token operator">:</span> <span class="token string">&#39;./src/main.js&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token string">&#39;./dist/bundle.js&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.json$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                jsonLoader
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">MyPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-ejs line-numbers-mode" data-ext="ejs"><pre class="language-ejs"><code>(() =&gt; {
    const __webpack_modules__ = [
        <span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%</span><span class="token language-javascript"> data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">info</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
            [(module, exports, require) =&gt; {
                <span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%-</span><span class="token language-javascript"> info<span class="token punctuation">.</span>code </span><span class="token delimiter punctuation">%&gt;</span></span>
            }, <span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%-</span><span class="token language-javascript"> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>mapping<span class="token punctuation">)</span> </span><span class="token delimiter punctuation">%&gt;</span></span>],
        <span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%</span><span class="token language-javascript"> <span class="token punctuation">}</span><span class="token punctuation">)</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
    ]
    const cacheModules = {}

    const __webpack_require__ = (chunkId) =&gt; {
        
        const chunkModule = cacheModules[chunkId]
        if (chunkModule) {
            return chunkModule
        }
        const [fn, mapping] = __webpack_modules__[chunkId]
        const localRequire = (filePath) =&gt; {
            const id = mapping[filePath]
            return __webpack_require__(id)
        }
        const __webpack_exports__ = {}
        fn(__webpack_modules__, __webpack_exports__, localRequire)
        return __webpack_exports__
    }

    __webpack_require__(0)
})()
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> __webpack_modules__ <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> _foo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;foo.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> _foo<span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;main.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;foo.js&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>
            Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> <span class="token string">&quot;__esModule&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            exports<span class="token punctuation">.</span>foo <span class="token operator">=</span> foo<span class="token punctuation">;</span>

            <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;hello World&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
    <span class="token keyword">const</span> cacheModules <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">const</span> <span class="token function-variable function">__webpack_require__</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">chunkId</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> chunkModule <span class="token operator">=</span> cacheModules<span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>chunkModule<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> chunkModule
        <span class="token punctuation">}</span>
        <span class="token keyword">const</span> <span class="token punctuation">[</span>fn<span class="token punctuation">,</span> mapping<span class="token punctuation">]</span> <span class="token operator">=</span> __webpack_modules__<span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span>
        <span class="token keyword">const</span> <span class="token function-variable function">localRequire</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> id <span class="token operator">=</span> mapping<span class="token punctuation">[</span>filePath<span class="token punctuation">]</span>
            <span class="token keyword">return</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">const</span> __webpack_exports__ <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token function">fn</span><span class="token punctuation">(</span>__webpack_modules__<span class="token punctuation">,</span> __webpack_exports__<span class="token punctuation">,</span> localRequire<span class="token punctuation">)</span>
        <span class="token keyword">return</span> __webpack_exports__
    <span class="token punctuation">}</span>
    <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MyPlugin</span> <span class="token punctuation">{</span>
    <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;MyPlugin 启动&#39;</span><span class="token punctuation">)</span>

        compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#39;MyPlugin&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// 可以理解为此次打包的上下文</span>
            <span class="token keyword">const</span> code <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;代码体积大小:&#39;</span><span class="token punctuation">,</span> code<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">jsonLoader</span><span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addDeps</span><span class="token punctuation">(</span><span class="token string">&#39;jsonLoader&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">export default </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/studyLib/engineering/004Bundless.html" class="" aria-label="Bundless"><!--[--><!--]--> Bundless <!--[--><!--]--></a></span><span class="next"><a href="/studyLib/engineering/006%E6%A8%A1%E5%9D%97%E5%8C%96%E6%96%B9%E6%A1%88.html" class="" aria-label="模块化方案"><!--[--><!--]--> 模块化方案 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/studyLib/assets/app-72993491.js" defer></script>
  </body>
</html>
