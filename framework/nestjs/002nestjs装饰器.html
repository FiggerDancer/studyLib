<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.66">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/studyLib/assets/icon.jpeg"><title>NestJS中的装饰器 | 学习资源库</title><meta name="description" content="一个用于学习的 VuePress 站点">
    <link rel="preload" href="/studyLib/assets/style-97653313.css" as="style"><link rel="stylesheet" href="/studyLib/assets/style-97653313.css">
    <link rel="modulepreload" href="/studyLib/assets/app-72993491.js"><link rel="modulepreload" href="/studyLib/assets/002nestjs装饰器.html-0fb187a0.js"><link rel="modulepreload" href="/studyLib/assets/002nestjs装饰器.html-c78d21e8.js"><link rel="prefetch" href="/studyLib/assets/index.html-2efa10d1.js" as="script"><link rel="prefetch" href="/studyLib/assets/001offer.html-bac406b1.js" as="script"><link rel="prefetch" href="/studyLib/assets/001Sort.html-befbd5f8.js" as="script"><link rel="prefetch" href="/studyLib/assets/002LinkList.html-d9751673.js" as="script"><link rel="prefetch" href="/studyLib/assets/003BinaryTree.html-7e39dc29.js" as="script"><link rel="prefetch" href="/studyLib/assets/004Graph.html-73dd72b0.js" as="script"><link rel="prefetch" href="/studyLib/assets/005TrieTree.html-fb5bbdee.js" as="script"><link rel="prefetch" href="/studyLib/assets/006Greedy.html-463b0c00.js" as="script"><link rel="prefetch" href="/studyLib/assets/007BruteForceRecursion.html-c32612ce.js" as="script"><link rel="prefetch" href="/studyLib/assets/008Hash.html-dfd72b4a.js" as="script"><link rel="prefetch" href="/studyLib/assets/009DisjointSet.html-c1da4bda.js" as="script"><link rel="prefetch" href="/studyLib/assets/010KMP.html-08dc4939.js" as="script"><link rel="prefetch" href="/studyLib/assets/011Manacher.html-851a418a.js" as="script"><link rel="prefetch" href="/studyLib/assets/012Window.html-35ce89c5.js" as="script"><link rel="prefetch" href="/studyLib/assets/013大数据.html-08dc39af.js" as="script"><link rel="prefetch" href="/studyLib/assets/014位运算.html-7156ded7.js" as="script"><link rel="prefetch" href="/studyLib/assets/015动态规划.html-19b0a341.js" as="script"><link rel="prefetch" href="/studyLib/assets/016有序表.html-bd8c7167.js" as="script"><link rel="prefetch" href="/studyLib/assets/001es.html-61c7fbb3.js" as="script"><link rel="prefetch" href="/studyLib/assets/002lodash.html-2bcf0815.js" as="script"><link rel="prefetch" href="/studyLib/assets/003coding.html-f5926cd9.js" as="script"><link rel="prefetch" href="/studyLib/assets/001打包资源处理.html-24cdc3ab.js" as="script"><link rel="prefetch" href="/studyLib/assets/002webpack配置.html-220baa49.js" as="script"><link rel="prefetch" href="/studyLib/assets/003包管理工具.html-159b64a3.js" as="script"><link rel="prefetch" href="/studyLib/assets/004Bundless.html-ae5a7555.js" as="script"><link rel="prefetch" href="/studyLib/assets/005手写简单webpack.html-2bf49e9b.js" as="script"><link rel="prefetch" href="/studyLib/assets/006模块化方案.html-9a5a76f5.js" as="script"><link rel="prefetch" href="/studyLib/assets/007package和npm.html-8a15325e.js" as="script"><link rel="prefetch" href="/studyLib/assets/008前端质量保障.html-dfab7e01.js" as="script"><link rel="prefetch" href="/studyLib/assets/010rspack.html-19004f0d.js" as="script"><link rel="prefetch" href="/studyLib/assets/001CSS.html-77bdfb21.js" as="script"><link rel="prefetch" href="/studyLib/assets/002Browser.html-fb8c4e1d.js" as="script"><link rel="prefetch" href="/studyLib/assets/003JS.html-6511db18.js" as="script"><link rel="prefetch" href="/studyLib/assets/004Vue.html-60dc2bc0.js" as="script"><link rel="prefetch" href="/studyLib/assets/005React.html-9ec40e07.js" as="script"><link rel="prefetch" href="/studyLib/assets/006工程化.html-4474284b.js" as="script"><link rel="prefetch" href="/studyLib/assets/007Http.html-024ba735.js" as="script"><link rel="prefetch" href="/studyLib/assets/008算法.html-a7f80b9d.js" as="script"><link rel="prefetch" href="/studyLib/assets/011前端调试.html-2653b38b.js" as="script"><link rel="prefetch" href="/studyLib/assets/012装饰器.html-1143f938.js" as="script"><link rel="prefetch" href="/studyLib/assets/997面试题整理.html-30dd7c1f.js" as="script"><link rel="prefetch" href="/studyLib/assets/998HR面.html-4fe89dde.js" as="script"><link rel="prefetch" href="/studyLib/assets/999Other.html-2bafb8e9.js" as="script"><link rel="prefetch" href="/studyLib/assets/001nestjs.html-323234b5.js" as="script"><link rel="prefetch" href="/studyLib/assets/003nestjs切换上下文.html-97aab697.js" as="script"><link rel="prefetch" href="/studyLib/assets/001React.html-cf1dd876.js" as="script"><link rel="prefetch" href="/studyLib/assets/001Vue.html-fce47e30.js" as="script"><link rel="prefetch" href="/studyLib/assets/404.html-f9875e7b.js" as="script"><link rel="prefetch" href="/studyLib/assets/index.html-0c7c69f6.js" as="script"><link rel="prefetch" href="/studyLib/assets/001offer.html-191fdbe5.js" as="script"><link rel="prefetch" href="/studyLib/assets/001Sort.html-280b53df.js" as="script"><link rel="prefetch" href="/studyLib/assets/002LinkList.html-fb9c1719.js" as="script"><link rel="prefetch" href="/studyLib/assets/003BinaryTree.html-9a24013b.js" as="script"><link rel="prefetch" href="/studyLib/assets/004Graph.html-0dad7abb.js" as="script"><link rel="prefetch" href="/studyLib/assets/005TrieTree.html-34ca2d6a.js" as="script"><link rel="prefetch" href="/studyLib/assets/006Greedy.html-78f96504.js" as="script"><link rel="prefetch" href="/studyLib/assets/007BruteForceRecursion.html-b2eb33b2.js" as="script"><link rel="prefetch" href="/studyLib/assets/008Hash.html-244a9c67.js" as="script"><link rel="prefetch" href="/studyLib/assets/009DisjointSet.html-cfc4bfc7.js" as="script"><link rel="prefetch" href="/studyLib/assets/010KMP.html-2398b546.js" as="script"><link rel="prefetch" href="/studyLib/assets/011Manacher.html-4b7ab50b.js" as="script"><link rel="prefetch" href="/studyLib/assets/012Window.html-42f82a81.js" as="script"><link rel="prefetch" href="/studyLib/assets/013大数据.html-0dcbf045.js" as="script"><link rel="prefetch" href="/studyLib/assets/014位运算.html-aa0f7ce8.js" as="script"><link rel="prefetch" href="/studyLib/assets/015动态规划.html-83a6ee15.js" as="script"><link rel="prefetch" href="/studyLib/assets/016有序表.html-7be4c959.js" as="script"><link rel="prefetch" href="/studyLib/assets/001es.html-18faa3ab.js" as="script"><link rel="prefetch" href="/studyLib/assets/002lodash.html-27e15aa1.js" as="script"><link rel="prefetch" href="/studyLib/assets/003coding.html-472500dc.js" as="script"><link rel="prefetch" href="/studyLib/assets/001打包资源处理.html-079090a7.js" as="script"><link rel="prefetch" href="/studyLib/assets/002webpack配置.html-1c5b4b6b.js" as="script"><link rel="prefetch" href="/studyLib/assets/003包管理工具.html-aea79c2b.js" as="script"><link rel="prefetch" href="/studyLib/assets/004Bundless.html-ee1d00f3.js" as="script"><link rel="prefetch" href="/studyLib/assets/005手写简单webpack.html-b669b110.js" as="script"><link rel="prefetch" href="/studyLib/assets/006模块化方案.html-1cb5a0fc.js" as="script"><link rel="prefetch" href="/studyLib/assets/007package和npm.html-f059a92c.js" as="script"><link rel="prefetch" href="/studyLib/assets/008前端质量保障.html-a2f1ba4f.js" as="script"><link rel="prefetch" href="/studyLib/assets/010rspack.html-bb5ff69e.js" as="script"><link rel="prefetch" href="/studyLib/assets/001CSS.html-d1d3362c.js" as="script"><link rel="prefetch" href="/studyLib/assets/002Browser.html-aaf69bf6.js" as="script"><link rel="prefetch" href="/studyLib/assets/003JS.html-deb0bda6.js" as="script"><link rel="prefetch" href="/studyLib/assets/004Vue.html-e1a4995f.js" as="script"><link rel="prefetch" href="/studyLib/assets/005React.html-b6a0b20d.js" as="script"><link rel="prefetch" href="/studyLib/assets/006工程化.html-b5a145c3.js" as="script"><link rel="prefetch" href="/studyLib/assets/007Http.html-b5f4113b.js" as="script"><link rel="prefetch" href="/studyLib/assets/008算法.html-08a07cf3.js" as="script"><link rel="prefetch" href="/studyLib/assets/011前端调试.html-4aa4bd45.js" as="script"><link rel="prefetch" href="/studyLib/assets/012装饰器.html-b7656a34.js" as="script"><link rel="prefetch" href="/studyLib/assets/997面试题整理.html-fc44ed4d.js" as="script"><link rel="prefetch" href="/studyLib/assets/998HR面.html-d0fbcf2a.js" as="script"><link rel="prefetch" href="/studyLib/assets/999Other.html-82442ece.js" as="script"><link rel="prefetch" href="/studyLib/assets/001nestjs.html-88dfddd2.js" as="script"><link rel="prefetch" href="/studyLib/assets/003nestjs切换上下文.html-e7c74e97.js" as="script"><link rel="prefetch" href="/studyLib/assets/001React.html-63986f09.js" as="script"><link rel="prefetch" href="/studyLib/assets/001Vue.html-4cac51c8.js" as="script"><link rel="prefetch" href="/studyLib/assets/404.html-11fb8e97.js" as="script"><link rel="prefetch" href="/studyLib/assets/mermaid.core-d22b6d45.js" as="script"><link rel="prefetch" href="/studyLib/assets/markdown.esm-abe06b83.js" as="script"><link rel="prefetch" href="/studyLib/assets/reveal.esm-ec5549c1.js" as="script"><link rel="prefetch" href="/studyLib/assets/VuePlayground-eb9a6c49.js" as="script"><link rel="prefetch" href="/studyLib/assets/giscus-765fdce2.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="切换侧边栏" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/studyLib/" class=""><!----><span class="site-name">学习资源库</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/studyLib/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/studyLib/algorithm/001Sort.md" class="" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/studyLib/LeetCode/001offer.md" class="" aria-label="LeetCode"><!--[--><!--]--> LeetCode <!--[--><!--]--></a></div><div class="navbar-item"><a href="/studyLib/engineering/001打包资源处理.md" class="" aria-label="工程化"><!--[--><!--]--> 工程化 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="框架"><span class="title">框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="框架"><span class="title">框架</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/studyLib/framework/vue/001Vue.md" class="" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/studyLib/framework/react/001React.md" class="" aria-label="React"><!--[--><!--]--> React <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/studyLib/framework/nestjs/001nestjs.md" class="" aria-label="NestJS"><!--[--><!--]--> NestJS <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="面试"><span class="title">面试</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="面试"><span class="title">面试</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/studyLib/questions/001CSS.md" class="" aria-label="问题"><!--[--><!--]--> 问题 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/studyLib/coding/001es.md" class="" aria-label="代码"><!--[--><!--]--> 代码 <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/studyLib/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/studyLib/algorithm/001Sort.md" class="" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/studyLib/LeetCode/001offer.md" class="" aria-label="LeetCode"><!--[--><!--]--> LeetCode <!--[--><!--]--></a></div><div class="navbar-item"><a href="/studyLib/engineering/001打包资源处理.md" class="" aria-label="工程化"><!--[--><!--]--> 工程化 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="框架"><span class="title">框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="框架"><span class="title">框架</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/studyLib/framework/vue/001Vue.md" class="" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/studyLib/framework/react/001React.md" class="" aria-label="React"><!--[--><!--]--> React <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/studyLib/framework/nestjs/001nestjs.md" class="" aria-label="NestJS"><!--[--><!--]--> NestJS <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="面试"><span class="title">面试</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="面试"><span class="title">面试</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/studyLib/questions/001CSS.md" class="" aria-label="问题"><!--[--><!--]--> 问题 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/studyLib/coding/001es.md" class="" aria-label="代码"><!--[--><!--]--> 代码 <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/studyLib/framework/nestjs/001nestjs.html" class="sidebar-item sidebar-heading" aria-label="NestJS"><!--[--><!--]--> NestJS <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html" class="router-link-active router-link-exact-active router-link-active sidebar-item sidebar-heading active" aria-label="NestJS中的装饰器"><!--[--><!--]--> NestJS中的装饰器 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#module-声明模块" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Module 声明模块"><!--[--><!--]--> @Module 声明模块 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#controller-controller" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Controller controller"><!--[--><!--]--> @Controller controller <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#injectable-注入" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Injectable 注入"><!--[--><!--]--> @Injectable 注入 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#optional-参数可选" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Optional 参数可选"><!--[--><!--]--> @Optional 参数可选 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#global-全局" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Global 全局"><!--[--><!--]--> @Global 全局 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#catch-捕获异常" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Catch 捕获异常"><!--[--><!--]--> @Catch 捕获异常 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#usefilters-过滤器抛错" class="router-link-active router-link-exact-active sidebar-item" aria-label="@UseFilters 过滤器抛错"><!--[--><!--]--> @UseFilters 过滤器抛错 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#useguards-守卫" class="router-link-active router-link-exact-active sidebar-item" aria-label="@UseGuards 守卫"><!--[--><!--]--> @UseGuards 守卫 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#useinterceptors-拦截器" class="router-link-active router-link-exact-active sidebar-item" aria-label="@UseInterceptors 拦截器"><!--[--><!--]--> @UseInterceptors 拦截器 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#usepipes-pipe管道" class="router-link-active router-link-exact-active sidebar-item" aria-label="@UsePipes pipe管道"><!--[--><!--]--> @UsePipes pipe管道 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#param" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Param"><!--[--><!--]--> @Param <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#query" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Query"><!--[--><!--]--> @Query <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#post" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Post"><!--[--><!--]--> @Post <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#body-取到body部分" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Body 取到body部分"><!--[--><!--]--> @Body 取到body部分 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#put" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Put"><!--[--><!--]--> @Put <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#delete" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Delete"><!--[--><!--]--> @Delete <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#patch" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Patch"><!--[--><!--]--> @Patch <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#options" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Options"><!--[--><!--]--> @Options <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#head" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Head"><!--[--><!--]--> @Head <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#setmetadata" class="router-link-active router-link-exact-active sidebar-item" aria-label="@SetMetadata"><!--[--><!--]--> @SetMetadata <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#headers" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Headers"><!--[--><!--]--> @Headers <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#ip" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Ip"><!--[--><!--]--> @Ip <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#session" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Session"><!--[--><!--]--> @Session <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#hostparam" class="router-link-active router-link-exact-active sidebar-item" aria-label="HostParam"><!--[--><!--]--> HostParam <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#req-或者-request" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Req 或者 @Request"><!--[--><!--]--> @Req 或者 @Request <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#res-或-response" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Res 或 @Response"><!--[--><!--]--> @Res 或 @Response <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#next" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Next"><!--[--><!--]--> @Next <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#httpcode" class="router-link-active router-link-exact-active sidebar-item" aria-label="@HttpCode"><!--[--><!--]--> @HttpCode <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#header" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Header"><!--[--><!--]--> @Header <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#redirect装饰器重定向" class="router-link-active router-link-exact-active sidebar-item" aria-label="@Redirect装饰器重定向"><!--[--><!--]--> @Redirect装饰器重定向 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#指定渲染引擎" class="router-link-active router-link-exact-active sidebar-item" aria-label="指定渲染引擎"><!--[--><!--]--> 指定渲染引擎 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#合并装饰器" class="router-link-active router-link-exact-active sidebar-item" aria-label="合并装饰器"><!--[--><!--]--> 合并装饰器 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#自定义装饰器" class="router-link-active router-link-exact-active sidebar-item" aria-label="自定义装饰器"><!--[--><!--]--> 自定义装饰器 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#metadata和reflector" class="router-link-active router-link-exact-active sidebar-item" aria-label="Metadata和Reflector"><!--[--><!--]--> Metadata和Reflector <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/studyLib/framework/nestjs/002nestjs%E8%A3%85%E9%A5%B0%E5%99%A8.html#创建循环依赖" class="router-link-active router-link-exact-active sidebar-item" aria-label="创建循环依赖"><!--[--><!--]--> 创建循环依赖 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/studyLib/framework/nestjs/003nestjs%E5%88%87%E6%8D%A2%E4%B8%8A%E4%B8%8B%E6%96%87.html" class="sidebar-item sidebar-heading" aria-label="ExecutionContext Nest切换不同上下文"><!--[--><!--]--> ExecutionContext Nest切换不同上下文 <!--[--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="nestjs中的装饰器" tabindex="-1"><a class="header-anchor" href="#nestjs中的装饰器" aria-hidden="true">#</a> NestJS中的装饰器</h1><h2 id="module-声明模块" tabindex="-1"><a class="header-anchor" href="#module-声明模块" aria-hidden="true">#</a> @Module 声明模块</h2><h2 id="controller-controller" tabindex="-1"><a class="header-anchor" href="#controller-controller" aria-hidden="true">#</a> @Controller controller</h2><p>指定Controller的生效路径</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> host<span class="token operator">:</span> <span class="token string">&#39;:host.0.0.1&#39;</span><span class="token punctuation">,</span> path<span class="token operator">:</span> <span class="token string">&#39;aaa&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AaaController</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>这时候你会发现只有 host 满足 xx.0.0.1 的时候才会路由到这个 controller。</p><h2 id="injectable-注入" tabindex="-1"><a class="header-anchor" href="#injectable-注入" aria-hidden="true">#</a> @Injectable 注入</h2><h2 id="optional-参数可选" tabindex="-1"><a class="header-anchor" href="#optional-参数可选" aria-hidden="true">#</a> @Optional 参数可选</h2><h2 id="global-全局" tabindex="-1"><a class="header-anchor" href="#global-全局" aria-hidden="true">#</a> @Global 全局</h2><h2 id="catch-捕获异常" tabindex="-1"><a class="header-anchor" href="#catch-捕获异常" aria-hidden="true">#</a> @Catch 捕获异常</h2><h2 id="usefilters-过滤器抛错" tabindex="-1"><a class="header-anchor" href="#usefilters-过滤器抛错" aria-hidden="true">#</a> @UseFilters 过滤器抛错</h2><h2 id="useguards-守卫" tabindex="-1"><a class="header-anchor" href="#useguards-守卫" aria-hidden="true">#</a> @UseGuards 守卫</h2><h2 id="useinterceptors-拦截器" tabindex="-1"><a class="header-anchor" href="#useinterceptors-拦截器" aria-hidden="true">#</a> @UseInterceptors 拦截器</h2><h2 id="usepipes-pipe管道" tabindex="-1"><a class="header-anchor" href="#usepipes-pipe管道" aria-hidden="true">#</a> @UsePipes pipe管道</h2><h2 id="param" tabindex="-1"><a class="header-anchor" href="#param" aria-hidden="true">#</a> @Param</h2><p>取 /xxx/111</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Controller</span> <span class="token punctuation">{</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&#39;/xxx/:aaa&#39;</span><span class="token punctuation">)</span>
    <span class="token function">getHello2</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Param</span></span><span class="token punctuation">(</span><span class="token string">&#39;aaa&#39;</span><span class="token punctuation">,</span> ParseIntPipe<span class="token punctuation">)</span> aaa<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">Query</span></span><span class="token punctuation">(</span><span class="token string">&#39;bbb&#39;</span><span class="token punctuation">,</span> ParseBoolPipe<span class="token punctuation">)</span> bbb<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> aaa<span class="token punctuation">,</span> <span class="token keyword">typeof</span> bbb<span class="token punctuation">)</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>aaa<span class="token punctuation">,</span> bbb<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="query" tabindex="-1"><a class="header-anchor" href="#query" aria-hidden="true">#</a> @Query</h2><h2 id="post" tabindex="-1"><a class="header-anchor" href="#post" aria-hidden="true">#</a> @Post</h2><h2 id="body-取到body部分" tabindex="-1"><a class="header-anchor" href="#body-取到body部分" aria-hidden="true">#</a> @Body 取到body部分</h2><p>我们一般用dto的class来接受请求体里的参数</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">AaaDto</span> <span class="token punctuation">{</span>
    a<span class="token operator">:</span> <span class="token builtin">number</span>
    b<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>nest会实例化一个dto对象</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;a&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;b&quot;</span><span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="put" tabindex="-1"><a class="header-anchor" href="#put" aria-hidden="true">#</a> @Put</h2><h2 id="delete" tabindex="-1"><a class="header-anchor" href="#delete" aria-hidden="true">#</a> @Delete</h2><h2 id="patch" tabindex="-1"><a class="header-anchor" href="#patch" aria-hidden="true">#</a> @Patch</h2><h2 id="options" tabindex="-1"><a class="header-anchor" href="#options" aria-hidden="true">#</a> @Options</h2><h2 id="head" tabindex="-1"><a class="header-anchor" href="#head" aria-hidden="true">#</a> @Head</h2><h2 id="setmetadata" tabindex="-1"><a class="header-anchor" href="#setmetadata" aria-hidden="true">#</a> @SetMetadata</h2><p>handler和class可以通过@SetMetadata指定metadata，然后在guard或者interceptor中取出</p><h2 id="headers" tabindex="-1"><a class="header-anchor" href="#headers" aria-hidden="true">#</a> @Headers</h2><p>可以通过它取某个请求头或者全部请求头</p><h2 id="ip" tabindex="-1"><a class="header-anchor" href="#ip" aria-hidden="true">#</a> @Ip</h2><p>通过它获取请求的ip</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&#39;/ip&#39;</span><span class="token punctuation">)</span>
<span class="token function">ip</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Ip</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> ip<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="session" tabindex="-1"><a class="header-anchor" href="#session" aria-hidden="true">#</a> @Session</h2><p>通过它获取session对象</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&#39;/session&#39;</span><span class="token punctuation">)</span>
<span class="token function">session</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Session</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> session<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>session<span class="token punctuation">.</span>count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        session<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">0</span> 
    <span class="token punctuation">}</span>
    session<span class="token punctuation">.</span>count <span class="token operator">=</span> session<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">return</span> session<span class="token punctuation">.</span>count
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>但要使用session需要安装一个express中间件，express-session</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> NestFactory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@nestjs/core&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AppModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./app.module&#39;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> session <span class="token keyword">from</span> <span class="token string">&#39;express-session&#39;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">await</span> NestFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span>
    <span class="token comment">// 指定加密的密钥和cookie的存活时间</span>
    app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        secret<span class="token operator">:</span> <span class="token string">&#39;lxy123&#39;</span><span class="token punctuation">,</span>
        cookie<span class="token operator">:</span> <span class="token punctuation">{</span>
            maxAge<span class="token operator">:</span> <span class="token number">100000</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="hostparam" tabindex="-1"><a class="header-anchor" href="#hostparam" aria-hidden="true">#</a> HostParam</h2><p>获取域名参数</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> HostParam <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@nestjs/common&#39;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> host<span class="token operator">:</span> <span class="token string">&#39;:host.0.0.1&#39;</span><span class="token punctuation">,</span> path<span class="token operator">:</span> <span class="token string">&#39;aaa&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AaaController</span> <span class="token punctuation">{</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&#39;bbb&#39;</span><span class="token punctuation">)</span>
    <span class="token function">hello</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">HostParam</span></span><span class="token punctuation">(</span><span class="token string">&#39;host&#39;</span><span class="token punctuation">)</span> host<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> host
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="req-或者-request" tabindex="-1"><a class="header-anchor" href="#req-或者-request" aria-hidden="true">#</a> @Req 或者 @Request</h2><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">AaaController</span> <span class="token punctuation">{</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&#39;ccc&#39;</span><span class="token punctuation">)</span> 
    <span class="token function">ccc</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Req</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> req<span class="token operator">:</span> Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>hostname<span class="token punctuation">)</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="res-或-response" tabindex="-1"><a class="header-anchor" href="#res-或-response" aria-hidden="true">#</a> @Res 或 @Response</h2><p>如果不返回响应，服务器会一直没有响应，可以自己返回响应</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">AaaController</span> <span class="token punctuation">{</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&#39;ddd&#39;</span><span class="token punctuation">)</span> 
    <span class="token function">ddd</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Res</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> res<span class="token operator">:</span> Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 如果不返回响应，服务器会一直没有响应</span>
        <span class="token comment">// 你可以自己返回响应</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;ddd&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Nest这么设计是为了防止你的响应和Nest返回的响应冲突，通过passthrough参数告诉Nest，自己不会返回响应</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">AaaController</span> <span class="token punctuation">{</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&#39;ddd&#39;</span><span class="token punctuation">)</span> 
    <span class="token function">ddd</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Res</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> passthrough<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> res<span class="token operator">:</span> Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&#39;ddd&#39;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="next" tabindex="-1"><a class="header-anchor" href="#next" aria-hidden="true">#</a> @Next</h2><p>当你有两个handler来处理同一个路由的时候，可以在第一个handler里注入next，调用它来请求转发到第二个handler</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">AaaController</span> <span class="token punctuation">{</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&#39;eee&#39;</span><span class="token punctuation">)</span>
    <span class="token function">eee</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Next</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> next<span class="token operator">:</span> NextFunction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;handler1&#39;</span><span class="token punctuation">)</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token string">&#39;111&#39;</span>
    <span class="token punctuation">}</span>

    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&#39;eee&#39;</span><span class="token punctuation">)</span>
    <span class="token function">eee2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;handler2&#39;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token string">&#39;eee&#39;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="httpcode" tabindex="-1"><a class="header-anchor" href="#httpcode" aria-hidden="true">#</a> @HttpCode</h2><p>handler默认返回200状态码，该装饰器可修改</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">AaaController</span> <span class="token punctuation">{</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&#39;fff&#39;</span><span class="token punctuation">)</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">HttpCode</span></span><span class="token punctuation">(</span><span class="token number">222</span><span class="token punctuation">)</span>
    <span class="token function">fff</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&#39;hello&#39;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>   
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="header" tabindex="-1"><a class="header-anchor" href="#header" aria-hidden="true">#</a> @Header</h2><p>修改response header</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&#39;ggg&#39;</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Header</span></span><span class="token punctuation">(</span><span class="token string">&#39;aaa&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;bbb&#39;</span><span class="token punctuation">)</span>
<span class="token function">ggg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&#39;hello&#39;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="redirect装饰器重定向" tabindex="-1"><a class="header-anchor" href="#redirect装饰器重定向" aria-hidden="true">#</a> @Redirect装饰器重定向</h2><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&#39;hhh&#39;</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Redirect</span></span><span class="token punctuation">(</span><span class="token string">&#39;https://lxy951101.github.io/studyLib/&#39;</span><span class="token punctuation">)</span>
<span class="token function">hhh</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="指定渲染引擎" tabindex="-1"><a class="header-anchor" href="#指定渲染引擎" aria-hidden="true">#</a> 指定渲染引擎</h2><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> NestFactory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@nestjs/core&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AppModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./app.module&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> NestExpressApplication <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@nestjs/platform-express&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> join <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;path&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">await</span> NestFactory<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">create</span><span class="token generic class-name"><span class="token operator">&lt;</span>NestExpressApplication<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span><span class="token punctuation">;</span>

  app<span class="token punctuation">.</span><span class="token function">useStaticAssets</span><span class="token punctuation">(</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;..&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;public&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">setBaseViewsDir</span><span class="token punctuation">(</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;..&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;views&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">setViewEngine</span><span class="token punctuation">(</span><span class="token string">&#39;hbs&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="合并装饰器" tabindex="-1"><a class="header-anchor" href="#合并装饰器" aria-hidden="true">#</a> 合并装饰器</h2><p>applyDecorators</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> applyDecorators<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> UseGuards <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@nestjs/common&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Aaa <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./aaa.decorator&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AaaGuard <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./aaa.guard&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">Bbb</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> role<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">applyDecorators</span><span class="token punctuation">(</span>
    <span class="token function">Get</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">Aaa</span><span class="token punctuation">(</span>role<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">UseGuards</span><span class="token punctuation">(</span>AaaGuard<span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="自定义装饰器" tabindex="-1"><a class="header-anchor" href="#自定义装饰器" aria-hidden="true">#</a> 自定义装饰器</h2><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">const</span> MyQuery <span class="token operator">=</span> <span class="token function">createParamDecorator</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> ctx<span class="token operator">:</span> ExecutionContext<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> request<span class="token operator">:</span> Request <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">switchToHttp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> request<span class="token punctuation">.</span>query<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="metadata和reflector" tabindex="-1"><a class="header-anchor" href="#metadata和reflector" aria-hidden="true">#</a> Metadata和Reflector</h2><ol><li>Reflect.defineMetadata</li><li>Reflect.getMetadata</li></ol><p>现在NestJS中是依赖了ts的emitDecoratorMetadata编译选项</p><h2 id="创建循环依赖" tabindex="-1"><a class="header-anchor" href="#创建循环依赖" aria-hidden="true">#</a> 创建循环依赖</h2><p>可以通过forwardRef</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> forwardRef<span class="token punctuation">,</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@nestjs/common&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> BbbModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;src/bbb/bbb.module&#39;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    imports<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token function">forwardRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> BbbModule<span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> forwardRef<span class="token punctuation">,</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@nestjs/common&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AaaModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;src/aaa/aaa.module&#39;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    imports<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token function">forwardRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> AaaModule<span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/studyLib/framework/nestjs/001nestjs.html" class="" aria-label="NestJS"><!--[--><!--]--> NestJS <!--[--><!--]--></a></span><span class="next"><a href="/studyLib/framework/nestjs/003nestjs%E5%88%87%E6%8D%A2%E4%B8%8A%E4%B8%8B%E6%96%87.html" class="" aria-label="ExecutionContext Nest切换不同上下文"><!--[--><!--]--> ExecutionContext Nest切换不同上下文 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/studyLib/assets/app-72993491.js" defer></script>
  </body>
</html>
